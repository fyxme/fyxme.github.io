<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>fyx(me) â€“ Convert ETL to Pcap</title><link>https://fyx.me/tags/convert-etl-to-pcap/</link><description>Recent content in Convert ETL to Pcap on fyx(me)</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><atom:link href="https://fyx.me/tags/convert-etl-to-pcap/index.xml" rel="self" type="application/rss+xml"/><item><title/><link>https://fyx.me/bazaar/windows/forensics/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://fyx.me/bazaar/windows/forensics/</guid><description>
&lt;h3>Event logs&lt;span class="hx-absolute -hx-mt-20" id="event-logs">&lt;/span>
&lt;a href="#event-logs" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;pre>&lt;code># list event logs
Get-EventLog -List
# search eventlogs
Get-EventLog -LogName &amp;#34;NAME&amp;#34; | where {$_.Message -like &amp;#39;*CUSTOM*&amp;#39;} | select Message | format-table -wrap
# same same but different
Get-EventLog -LogName &amp;#34;NAME&amp;#34; | where {$_.Message -like &amp;#39;*CUSTOM*&amp;#39;} | select Message | fl&lt;/code>&lt;/pre>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>Network Packet Capture&lt;span class="hx-absolute -hx-mt-20" id="network-packet-capture">&lt;/span>
&lt;a href="#network-packet-capture" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-blue-200 hx-bg-blue-100 hx-text-blue-900 dark:hx-border-blue-200/30 dark:hx-bg-blue-900/30 dark:hx-text-blue-200">
&lt;p class="hx-flex hx-items-center hx-font-medium">&lt;svg height=16px class="hx-inline-block hx-align-middle hx-mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>&lt;/svg>Note&lt;/p>
&lt;div class="hx-w-full hx-min-w-0 hx-leading-7">
&lt;div class="hx-mt-6 hx-leading-7 first:hx-mt-0">&lt;p>Windows now ships with pktmon which contains a lot of the below funtionality builtin. Worth a look. &lt;br />
Ref: &lt;a href="https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/pktmon" target="_blank" rel="noopener">https://learn.microsoft.com/en-us/windows-server/administration/windows-commands/pktmon&lt;/a>&lt;/p>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>The Windows &lt;code>netsh&lt;/code> built-in utility can be used to the traffic of the local system. The network capture will be exported in the &lt;code>ETL&lt;/code> format:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-powershell" data-lang="powershell">&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Captures the local network traffic, optionally to the specified IP.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">trace&lt;/span> &lt;span class="nb">start &lt;/span>&lt;span class="n">capture&lt;/span>&lt;span class="p">=&lt;/span>&lt;span class="n">yes&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">tracefile&lt;/span>&lt;span class="p">=&amp;lt;&lt;/span>&lt;span class="n">OUTPUT_ETL&lt;/span>&lt;span class="p">&amp;gt;]&lt;/span> &lt;span class="p">[&lt;/span>&lt;span class="n">IPv4&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">Address&lt;/span>&lt;span class="p">=&amp;lt;&lt;/span>&lt;span class="n">IP&lt;/span>&lt;span class="p">&amp;gt;]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># netsh trace start capture=yes report=disabled&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c"># Stops the network capture.&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="n">netsh&lt;/span> &lt;span class="n">trace&lt;/span> &lt;span class="n">stop&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h4>Convert to pcap using etl2pcapng&lt;span class="hx-absolute -hx-mt-20" id="convert-to-pcap-using-etl2pcapng">&lt;/span>
&lt;a href="#convert-to-pcap-using-etl2pcapng" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;blockquote>
&lt;p>Windows: &lt;a href="https://github.com/microsoft/etl2pcapng" target="_blank" rel="noopener">https://github.com/microsoft/etl2pcapng&lt;/a>&lt;/p>
&lt;p>Linux: &lt;a href="https://github.com/aaptel/etl2pcap.git" target="_blank" rel="noopener">https://github.com/aaptel/etl2pcap.git&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h4>Merge multiple pcaps together&lt;span class="hx-absolute -hx-mt-20" id="merge-multiple-pcaps-together">&lt;/span>
&lt;a href="#merge-multiple-pcaps-together" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># linux&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">mergecap -w &amp;lt;new pcap&amp;gt; &amp;lt;pcap 1&amp;gt; &amp;lt;pcap 2&amp;gt; &lt;span class="o">[&lt;/span>...&lt;span class="o">]&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div></description></item></channel></rss>