<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="index, follow"><link rel="icon shortcut" href=/favicon.ico sizes=32x32><link rel=icon href=/favicon.svg type=image/svg+xml><link rel=icon href=/favicon-dark.svg type=image/svg+xml media="(prefers-color-scheme: dark)"><link rel=icon href=/favicon-16x16.png type=image/png sizes=16x16><link rel=icon href=/favicon-32x32.png type=image/png sizes=32x32><link rel=apple-touch-icon href=/apple-touch-icon.png sizes=180x180><link fetchpriority=low href=/site.webmanifest rel=manifest><title>Replicating Cobalt Strike's Port Scanner BOF for Open-Source C2 | Fast OPSEC-Aware Ping & TCP Connect Scanning in C â€“ fyx(me)</title>
<meta name=description content="Discover how to replicate Cobalt Strike's advanced port scanning and host discovery features using BOFs for open-source C2 frameworks. Learn about OPSEC considerations, fast ping and TCP connect scans in C, argument parsing, banner grabbing, and integration for red team operations. Includes full technical breakdown and source code examples."><link rel=canonical href=https://fyx.me/articles/replicating-cobalt-strikes-port-scanner-as-a-bof-for-open-source-c2-frameworks/ itemprop=url><meta property="og:title" content="fyx(me) - Replicating Cobalt Strike's Port Scanner BOF for Open-Source C2 | Fast OPSEC-Aware Ping & TCP Connect Scanning in C"><meta property="og:description" content="Discover how to replicate Cobalt Strike's advanced port scanning and host discovery features using BOFs for open-source C2 frameworks. Learn about OPSEC considerations, fast ping and TCP connect scans in C, argument parsing, banner grabbing, and integration for red team operations. Includes full technical breakdown and source code examples."><meta property="og:type" content="article"><meta property="og:url" content="https://fyx.me/articles/replicating-cobalt-strikes-port-scanner-as-a-bof-for-open-source-c2-frameworks/"><meta property="og:image" content="https://fyx.me/opengraph/content-articles-replicating-cobalt-strikes-port-scanner-as-a-bof-for-open-source-c2-frameworks.webp"><meta property="article:section" content="articles"><meta property="article:published_time" content="2025-01-24T00:00:00+00:00"><meta property="article:modified_time" content="2025-01-24T00:00:00+00:00"><meta property="og:site_name" content="fyx(me)"><meta itemprop=name content="Replicating Cobalt Strike's Port Scanner BOF for Open-Source C2 | Fast OPSEC-Aware Ping & TCP Connect Scanning in C"><meta itemprop=description content="Discover how to replicate Cobalt Strike's advanced port scanning and host discovery features using BOFs for open-source C2 frameworks. Learn about OPSEC considerations, fast ping and TCP connect scans in C, argument parsing, banner grabbing, and integration for red team operations. Includes full technical breakdown and source code examples."><meta itemprop=datePublished content="2025-01-24T00:00:00+00:00"><meta itemprop=dateModified content="2025-01-24T00:00:00+00:00"><meta itemprop=wordCount content="3309"><meta itemprop=image content="https://fyx.me/opengraph/content-articles-replicating-cobalt-strikes-port-scanner-as-a-bof-for-open-source-c2-frameworks.webp"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://fyx.me/opengraph/content-articles-replicating-cobalt-strikes-port-scanner-as-a-bof-for-open-source-c2-frameworks.webp"><meta name=twitter:title content="Replicating Cobalt Strike's Port Scanner BOF for Open-Source C2 | Fast OPSEC-Aware Ping & TCP Connect Scanning in C"><meta name=twitter:description content="Discover how to replicate Cobalt Strike's advanced port scanning and host discovery features using BOFs for open-source C2 frameworks. Learn about OPSEC considerations, fast ping and TCP connect scans in C, argument parsing, banner grabbing, and integration for red team operations. Includes full technical breakdown and source code examples."><link rel=preload href=/css/compiled/main.min.33b308ec8b8d5df72a614d7504ed2df3405a9b1d19cf059dc9c4d88f0b8a2551.css as=style integrity="sha256-M7MI7IuNXfcqYU11BO0t80Bamx0ZzwWdycTYjwuKJVE="><link href=/css/compiled/main.min.33b308ec8b8d5df72a614d7504ed2df3405a9b1d19cf059dc9c4d88f0b8a2551.css rel=stylesheet integrity="sha256-M7MI7IuNXfcqYU11BO0t80Bamx0ZzwWdycTYjwuKJVE="><link href=/css/custom.min.75faa5aabcce436ee4a0ab975a262b5893cb7250a4b631c0c299d911fbca5afb.css rel=stylesheet integrity="sha256-dfqlqrzOQ27koKuXWiYrWJPLclCktjHAwpnZEfvKWvs="><script>const defaultTheme="dark",setDarkTheme=()=>{document.documentElement.classList.add("dark"),document.documentElement.style.colorScheme="dark"},setLightTheme=()=>{document.documentElement.classList.remove("dark"),document.documentElement.style.colorScheme="light"};"color-theme"in localStorage?localStorage.getItem("color-theme")==="dark"?setDarkTheme():setLightTheme():(defaultTheme==="dark"?setDarkTheme():setLightTheme(),defaultTheme==="system"&&(window.matchMedia("(prefers-color-scheme: dark)").matches?setDarkTheme():setLightTheme()))</script><script defer src=https://a.blinking.dog/script.js data-website-id=ec9f3909-7c35-4c7e-a1cd-5c9248950e26 data-domains=fyx.me,www.fyx.me></script></head><body dir=ltr><div class="nav-container hx-sticky hx-top-0 hx-z-20 hx-w-full hx-bg-transparent print:hx-hidden"><div class="nav-container-blur hx-pointer-events-none hx-absolute hx-z-[-1] hx-h-full hx-w-full hx-bg-white dark:hx-bg-dark hx-shadow-[0_2px_4px_rgba(0,0,0,.02),0_1px_0_rgba(0,0,0,.06)] contrast-more:hx-shadow-[0_0_0_1px_#000] dark:hx-shadow-[0_-1px_0_rgba(255,255,255,.1)_inset] contrast-more:dark:hx-shadow-[0_0_0_1px_#fff]"></div><nav class="hx-mx-auto hx-flex hx-items-center hx-justify-end hx-gap-2 hx-h-16 hx-px-6 hx-max-w-[90rem]"><a class="hx-flex hx-items-center hover:hx-opacity-75 ltr:hx-mr-auto rtl:hx-ml-auto" href=/><img class="hx-block dark:hx-hidden" src=/images/fyxme.svg alt=fyx(me) height=20 width=30>
<img class="hx-hidden dark:hx-block" src=/images/fyxme.svg alt=fyx(me) height=20 width=30>
<span class="hx-mx-2 hx-font-extrabold hx-inline hx-select-none" title=fyx(me)>fyx(me)</span>
</a><a title=about href=/about class="hx-text-sm contrast-more:hx-text-gray-700 contrast-more:dark:hx-text-gray-100 hx-relative -hx-ml-2 hx-hidden hx-whitespace-nowrap hx-p-2 md:hx-inline-block hx-text-gray-600 hover:hx-text-gray-800 dark:hx-text-gray-400 dark:hover:hx-text-gray-200"><span class=hx-text-center>about</span>
</a><a title=articles href=/articles class="hx-text-sm contrast-more:hx-text-gray-700 contrast-more:dark:hx-text-gray-100 hx-relative -hx-ml-2 hx-hidden hx-whitespace-nowrap hx-p-2 md:hx-inline-block hx-font-medium"><span class=hx-text-center>articles</span>
</a><a title=minis href=/minis class="hx-text-sm contrast-more:hx-text-gray-700 contrast-more:dark:hx-text-gray-100 hx-relative -hx-ml-2 hx-hidden hx-whitespace-nowrap hx-p-2 md:hx-inline-block hx-text-gray-600 hover:hx-text-gray-800 dark:hx-text-gray-400 dark:hover:hx-text-gray-200"><span class=hx-text-center>minis</span>
</a><a title=code href=/code class="hx-text-sm contrast-more:hx-text-gray-700 contrast-more:dark:hx-text-gray-100 hx-relative -hx-ml-2 hx-hidden hx-whitespace-nowrap hx-p-2 md:hx-inline-block hx-text-gray-600 hover:hx-text-gray-800 dark:hx-text-gray-400 dark:hover:hx-text-gray-200"><span class=hx-text-center>code</span>
</a><a title=bazaar href=/bazaar class="hx-text-sm contrast-more:hx-text-gray-700 contrast-more:dark:hx-text-gray-100 hx-relative -hx-ml-2 hx-hidden hx-whitespace-nowrap hx-p-2 md:hx-inline-block hx-text-gray-600 hover:hx-text-gray-800 dark:hx-text-gray-400 dark:hover:hx-text-gray-200"><span class=hx-text-center>bazaar</span></a><div class="search-wrapper hx-relative md:hx-w-64"><div class="hx-relative hx-flex hx-items-center hx-text-gray-900 contrast-more:hx-text-gray-800 dark:hx-text-gray-300 contrast-more:dark:hx-text-gray-300"><input placeholder=Search... class="search-input hx-block hx-w-full hx-appearance-none hx-rounded-lg hx-px-3 hx-py-2 hx-transition-colors hx-text-base hx-leading-tight md:hx-text-sm hx-bg-black/[.05] dark:hx-bg-gray-50/10 focus:hx-bg-white dark:focus:hx-bg-dark placeholder:hx-text-gray-500 dark:placeholder:hx-text-gray-400 contrast-more:hx-border contrast-more:hx-border-current" type=search spellcheck=false>
<kbd class="hx-absolute hx-my-1.5 hx-select-none ltr:hx-right-1.5 rtl:hx-left-1.5 hx-h-5 hx-rounded hx-bg-white hx-px-1.5 hx-font-mono hx-text-[10px] hx-font-medium hx-text-gray-500 hx-border dark:hx-border-gray-100/20 dark:hx-bg-dark/50 contrast-more:hx-border-current contrast-more:hx-text-current contrast-more:dark:hx-border-current hx-items-center hx-gap-1 hx-transition-opacity hx-pointer-events-none hx-hidden sm:hx-flex">CTRL K</kbd></div><div><ul class="search-results hextra-scrollbar hx-hidden hx-border hx-border-gray-200 hx-bg-white hx-text-gray-100 dark:hx-border-neutral-800 dark:hx-bg-neutral-900 hx-absolute hx-top-full hx-z-20 hx-mt-2 hx-overflow-auto hx-overscroll-contain hx-rounded-xl hx-py-2.5 hx-shadow-xl hx-max-h-[min(calc(50vh-11rem-env(safe-area-inset-bottom)),400px)] md:hx-max-h-[min(calc(100vh-5rem-env(safe-area-inset-bottom)),400px)] hx-inset-x-0 ltr:md:hx-left-auto rtl:md:hx-right-auto contrast-more:hx-border contrast-more:hx-border-gray-900 contrast-more:dark:hx-border-gray-50 hx-w-screen hx-min-h-[100px] hx-max-w-[min(calc(100vw-2rem),calc(100%+20rem))]" style="transition:max-height .2s ease 0s"></ul></div></div><a class="hx-p-2 hx-text-current" target=_blank rel=noreferrer href=https://github.com/fyxme/ title=github><svg height="24" fill="currentcolor" viewBox="3 3 18 18"><path d="M12 3C7.0275 3 3 7.12937 3 12.2276c0 4.0833 2.57625 7.5321 6.15374 8.7548C9.60374 21.0631 9.77249 20.7863 9.77249 20.5441 9.77249 20.3249 9.76125 19.5982 9.76125 18.8254 7.5 19.2522 6.915 18.2602 6.735 17.7412 6.63375 17.4759 6.19499 16.6569 5.8125 16.4378 5.4975 16.2647 5.0475 15.838 5.80124 15.8264 6.51 15.8149 7.01625 16.4954 7.18499 16.7723 7.99499 18.1679 9.28875 17.7758 9.80625 17.5335 9.885 16.9337 10.1212 16.53 10.38 16.2993 8.3775 16.0687 6.285 15.2728 6.285 11.7432c0-1.0035.34875-1.834.92249-2.47994C7.1175 9.03257 6.8025 8.08674 7.2975 6.81794c0 0 .753749999999999-.24223 2.47499.94583.72001-.20762 1.48501-.31143 2.25001-.31143C12.7875 7.45234 13.5525 7.55615 14.2725 7.76377c1.7212-1.19959 2.475-.94583 2.475-.94583C17.2424 8.08674 16.9275 9.03257 16.8375 9.26326 17.4113 9.9092 17.76 10.7281 17.76 11.7432c0 3.5411-2.1037 4.3255-4.1063 4.5561C13.98 16.5877 14.2613 17.1414 14.2613 18.0065 14.2613 19.2407 14.25 20.2326 14.25 20.5441 14.25 20.7863 14.4188 21.0746 14.8688 20.9824 16.6554 20.364 18.2079 19.1866 19.3078 17.6162c1.0999-1.5705 1.6917-3.4551 1.6922-5.3886C21 7.12937 16.9725 3 12 3z"/></svg>
<span class=hx-sr-only>github</span>
</a><a class="hx-p-2 hx-text-current" target=_blank rel=noreferrer href=https://x.com/_fyxme title=twitter><svg height="24" viewBox="0 0 24 24"><path fill="currentcolor" d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958.0 002.163-2.723c-.951.555-2.005.959-3.127 1.184A4.92 4.92.0 0011.78 8.288C7.69 8.095 4.067 6.13 1.64 3.162A4.822 4.822.0 00.974 5.637c0 1.71.87 3.213 2.188 4.096A4.904 4.904.0 01.934 9.117v.06a4.923 4.923.0 003.946 4.827 4.996 4.996.0 01-2.212.085 4.936 4.936.0 004.604 3.417A9.867 9.867.0 011.17 19.611c-.39.0-.779-.023-1.17-.067a13.995 13.995.0 007.557 2.209c9.053.0 13.998-7.496 13.998-13.985.0-.21.0-.42-.015-.63A9.935 9.935.0 0024 4.59z"/></svg><span class=hx-sr-only>twitter</span>
</a><button type=button aria-label=Menu class="hamburger-menu -hx-mr-2 hx-rounded hx-p-2 active:hx-bg-gray-400/20 md:hx-hidden"><svg height="24" fill="none" viewBox="0 0 24 24" stroke="currentcolor"><g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8H20"/></g><g><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16H20"/></g></svg></button></nav></div><div class="hx-mx-auto hx-flex hx-max-w-screen-xl"><div class="mobile-menu-overlay [transition:background-color_1.5s_ease] hx-fixed hx-inset-0 hx-z-10 hx-bg-black/80 dark:hx-bg-black/60 hx-hidden"></div><aside class="sidebar-container hx-flex hx-flex-col print:hx-hidden md:hx-top-16 md:hx-shrink-0 md:hx-w-64 md:hx-self-start max-md:[transform:translate3d(0,-100%,0)] md:hx-hidden xl:hx-block"><div class="hx-px-4 hx-pt-4 md:hx-hidden"><div class="search-wrapper hx-relative md:hx-w-64"><div class="hx-relative hx-flex hx-items-center hx-text-gray-900 contrast-more:hx-text-gray-800 dark:hx-text-gray-300 contrast-more:dark:hx-text-gray-300"><input placeholder=Search... class="search-input hx-block hx-w-full hx-appearance-none hx-rounded-lg hx-px-3 hx-py-2 hx-transition-colors hx-text-base hx-leading-tight md:hx-text-sm hx-bg-black/[.05] dark:hx-bg-gray-50/10 focus:hx-bg-white dark:focus:hx-bg-dark placeholder:hx-text-gray-500 dark:placeholder:hx-text-gray-400 contrast-more:hx-border contrast-more:hx-border-current" type=search spellcheck=false>
<kbd class="hx-absolute hx-my-1.5 hx-select-none ltr:hx-right-1.5 rtl:hx-left-1.5 hx-h-5 hx-rounded hx-bg-white hx-px-1.5 hx-font-mono hx-text-[10px] hx-font-medium hx-text-gray-500 hx-border dark:hx-border-gray-100/20 dark:hx-bg-dark/50 contrast-more:hx-border-current contrast-more:hx-text-current contrast-more:dark:hx-border-current hx-items-center hx-gap-1 hx-transition-opacity hx-pointer-events-none hx-hidden sm:hx-flex">CTRL K</kbd></div><div><ul class="search-results hextra-scrollbar hx-hidden hx-border hx-border-gray-200 hx-bg-white hx-text-gray-100 dark:hx-border-neutral-800 dark:hx-bg-neutral-900 hx-absolute hx-top-full hx-z-20 hx-mt-2 hx-overflow-auto hx-overscroll-contain hx-rounded-xl hx-py-2.5 hx-shadow-xl hx-max-h-[min(calc(50vh-11rem-env(safe-area-inset-bottom)),400px)] md:hx-max-h-[min(calc(100vh-5rem-env(safe-area-inset-bottom)),400px)] hx-inset-x-0 ltr:md:hx-left-auto rtl:md:hx-right-auto contrast-more:hx-border contrast-more:hx-border-gray-900 contrast-more:dark:hx-border-gray-50 hx-w-screen hx-min-h-[100px] hx-max-w-[min(calc(100vw-2rem),calc(100%+20rem))]" style="transition:max-height .2s ease 0s"></ul></div></div></div><div class="hextra-scrollbar hx-overflow-y-auto hx-overflow-x-hidden hx-p-4 hx-grow md:hx-h-[calc(100vh-var(--navbar-height)-var(--menu-height))]"><ul class="hx-flex hx-flex-col hx-gap-1 md:hx-hidden"><li><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/minis/>minis
<span class=hextra-sidebar-collapsible-button><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="hx-h-[18px] hx-min-w-[18px] hx-rounded-sm hx-p-0.5 hover:hx-bg-gray-800/5 dark:hover:hx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="hx-origin-center hx-transition-transform rtl:-hx-rotate-180"/></svg></span></a><div class="ltr:hx-pr-0 hx-overflow-hidden"><ul class='hx-relative hx-flex hx-flex-col hx-gap-1 before:hx-absolute before:hx-inset-y-1 before:hx-w-px before:hx-bg-gray-200 before:hx-content-[""] ltr:hx-ml-3 ltr:hx-pl-3 ltr:before:hx-left-0 rtl:hx-mr-3 rtl:hx-pr-3 rtl:before:hx-right-0 dark:before:hx-bg-neutral-800'><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/minis/reverse-engineering-onemillionchessboards.com-frontend-with-chrome-devtools-to-build-a-bot/>Reverse Engineering onemillionchessboards.com Frontend with DevTools to Build a Bot</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/minis/building-a-flask-blog-with-ai-coding-tools-using-cline-mcp-servers-in-vscode/>Building a Flask Blog in 3 prompts with AI Coding Tools: Using Cline & MCP Servers in VSCode</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/minis/leveraging-ai-to-automate-seo-metadata-generation-for-web-content/>Leveraging AI to Automate SEO Metadata Generation for Web Content</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/minis/ai-overthinking-more-than-me-with-insomnia-at-3-am/>AI overthinking more than me with insomnia at 3 am</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/minis/creating-lightweight-windows-virtual-machines-for-your-personal-lab-environment/>Creating Lightweight Windows Virtual Machines for your Personal Lab Environment</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/minis/create-infinite-email-aliases-using-cloudflare-email-routing/>Create Infinite Email aliases using Cloudflare Email Routing</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/minis/improving-functionality-of-open-source-bofs/>Improving functionality of Open Source BOFs</a></li></ul></div></li><li class=open><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/articles/>articles
<span class=hextra-sidebar-collapsible-button><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="hx-h-[18px] hx-min-w-[18px] hx-rounded-sm hx-p-0.5 hover:hx-bg-gray-800/5 dark:hover:hx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="hx-origin-center hx-transition-transform rtl:-hx-rotate-180"/></svg></span></a><div class="ltr:hx-pr-0 hx-overflow-hidden"><ul class='hx-relative hx-flex hx-flex-col hx-gap-1 before:hx-absolute before:hx-inset-y-1 before:hx-w-px before:hx-bg-gray-200 before:hx-content-[""] ltr:hx-ml-3 ltr:hx-pl-3 ltr:before:hx-left-0 rtl:hx-mr-3 rtl:hx-pr-3 rtl:before:hx-right-0 dark:before:hx-bg-neutral-800'><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/articles/creating-a-havoc-module-to-run-commands-on-all-agents-at-once-and-map-out-an-environment-passively/>Creating a Havoc Module to run commands on all agents at once and map out an environment passively</a></li><li class="hx-flex hx-flex-col open"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
sidebar-active-item hx-bg-primary-100 hx-font-semibold hx-text-primary-800 contrast-more:hx-border contrast-more:hx-border-primary-500 dark:hx-bg-primary-400/10 dark:hx-text-primary-600 contrast-more:dark:hx-border-primary-500" href=/articles/replicating-cobalt-strikes-port-scanner-as-a-bof-for-open-source-c2-frameworks/>Replicating Cobalt Strike's Port Scanner BOF for Open-Source C2 | Fast OPSEC-Aware Ping & TCP Connect Scanning in C</a><ul class='hx-flex hx-flex-col hx-gap-1 hx-relative before:hx-absolute before:hx-inset-y-1 before:hx-w-px before:hx-bg-gray-200 before:hx-content-[""] dark:before:hx-bg-neutral-800 ltr:hx-pl-3 ltr:before:hx-left-0 rtl:hx-pr-3 rtl:before:hx-right-0 ltr:hx-ml-3 rtl:hx-mr-3'><li><a href=# class="hx-flex hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [word-break:break-word] hx-cursor-pointer [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] contrast-more:hx-border hx-gap-2 before:hx-opacity-25 before:hx-content-['#'] hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:hx-text-gray-900 contrast-more:dark:hx-text-gray-50 contrast-more:hx-border-transparent contrast-more:hover:hx-border-gray-900 contrast-more:dark:hover:hx-border-gray-50"></a></li></ul></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/articles/osep-exam-review/>OffSec Experienced Penetration Tester (OSEP) Exam Review</a></li></ul></div></li><li><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/>bazaar
<span class=hextra-sidebar-collapsible-button><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="hx-h-[18px] hx-min-w-[18px] hx-rounded-sm hx-p-0.5 hover:hx-bg-gray-800/5 dark:hover:hx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="hx-origin-center hx-transition-transform rtl:-hx-rotate-180"/></svg></span></a><div class="ltr:hx-pr-0 hx-overflow-hidden"><ul class='hx-relative hx-flex hx-flex-col hx-gap-1 before:hx-absolute before:hx-inset-y-1 before:hx-w-px before:hx-bg-gray-200 before:hx-content-[""] ltr:hx-ml-3 ltr:hx-pl-3 ltr:before:hx-left-0 rtl:hx-mr-3 rtl:hx-pr-3 rtl:before:hx-right-0 dark:before:hx-bg-neutral-800'><li class="hx-flex hx-flex-col open"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/windows/>Windows
<span class=hextra-sidebar-collapsible-button><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="hx-h-[18px] hx-min-w-[18px] hx-rounded-sm hx-p-0.5 hover:hx-bg-gray-800/5 dark:hover:hx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="hx-origin-center hx-transition-transform rtl:-hx-rotate-180"/></svg></span></a><div class="ltr:hx-pr-0 hx-overflow-hidden"><ul class='hx-relative hx-flex hx-flex-col hx-gap-1 before:hx-absolute before:hx-inset-y-1 before:hx-w-px before:hx-bg-gray-200 before:hx-content-[""] ltr:hx-ml-3 ltr:hx-pl-3 ltr:before:hx-left-0 rtl:hx-mr-3 rtl:hx-pr-3 rtl:before:hx-right-0 dark:before:hx-bg-neutral-800'><li class="hx-flex hx-flex-col open"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/windows/active-directory/>Active Directory
<span class=hextra-sidebar-collapsible-button><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="hx-h-[18px] hx-min-w-[18px] hx-rounded-sm hx-p-0.5 hover:hx-bg-gray-800/5 dark:hover:hx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="hx-origin-center hx-transition-transform rtl:-hx-rotate-180"/></svg></span></a><div class="ltr:hx-pr-0 hx-overflow-hidden"><ul class='hx-relative hx-flex hx-flex-col hx-gap-1 before:hx-absolute before:hx-inset-y-1 before:hx-w-px before:hx-bg-gray-200 before:hx-content-[""] ltr:hx-ml-3 ltr:hx-pl-3 ltr:before:hx-left-0 rtl:hx-mr-3 rtl:hx-pr-3 rtl:before:hx-right-0 dark:before:hx-bg-neutral-800'><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/windows/active-directory/lateral-movement/>Lateral Movement</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/windows/active-directory/ad-enumeration/>AD Enumeration</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/windows/active-directory/mssql/>MSSQL</a></li></ul></div></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/windows/privilege-escalation/>Privilege Escalation</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/windows/post-exploitation--looting/>Post Exploitation & Looting</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/windows/defence-evasion/>Defence Evasion</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/windows/misc-snippets/>Misc Snippets</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/windows/forensics/>Forensics</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/windows/outlook-exchange-server/>Outlook Exchange Server</a></li></ul></div></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/linux/>Linux
<span class=hextra-sidebar-collapsible-button><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="hx-h-[18px] hx-min-w-[18px] hx-rounded-sm hx-p-0.5 hover:hx-bg-gray-800/5 dark:hover:hx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="hx-origin-center hx-transition-transform rtl:-hx-rotate-180"/></svg></span></a><div class="ltr:hx-pr-0 hx-overflow-hidden"><ul class='hx-relative hx-flex hx-flex-col hx-gap-1 before:hx-absolute before:hx-inset-y-1 before:hx-w-px before:hx-bg-gray-200 before:hx-content-[""] ltr:hx-ml-3 ltr:hx-pl-3 ltr:before:hx-left-0 rtl:hx-mr-3 rtl:hx-pr-3 rtl:before:hx-right-0 dark:before:hx-bg-neutral-800'><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/linux/other-commands/>Other Commands</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/linux/reverse-shells/>Reverse Shells</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/linux/system-hardening/>System Hardening</a></li></ul></div></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/phishing/>Phishing</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/web-exploitation/>Web Exploitation
<span class=hextra-sidebar-collapsible-button><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="hx-h-[18px] hx-min-w-[18px] hx-rounded-sm hx-p-0.5 hover:hx-bg-gray-800/5 dark:hover:hx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="hx-origin-center hx-transition-transform rtl:-hx-rotate-180"/></svg></span></a><div class="ltr:hx-pr-0 hx-overflow-hidden"><ul class='hx-relative hx-flex hx-flex-col hx-gap-1 before:hx-absolute before:hx-inset-y-1 before:hx-w-px before:hx-bg-gray-200 before:hx-content-[""] ltr:hx-ml-3 ltr:hx-pl-3 ltr:before:hx-left-0 rtl:hx-mr-3 rtl:hx-pr-3 rtl:before:hx-right-0 dark:before:hx-bg-neutral-800'><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/web-exploitation/php/>PHP</a></li></ul></div></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/c2-and-red-team-tools/>C2 and Red Team Tools
<span class=hextra-sidebar-collapsible-button><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="hx-h-[18px] hx-min-w-[18px] hx-rounded-sm hx-p-0.5 hover:hx-bg-gray-800/5 dark:hover:hx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="hx-origin-center hx-transition-transform rtl:-hx-rotate-180"/></svg></span></a><div class="ltr:hx-pr-0 hx-overflow-hidden"><ul class='hx-relative hx-flex hx-flex-col hx-gap-1 before:hx-absolute before:hx-inset-y-1 before:hx-w-px before:hx-bg-gray-200 before:hx-content-[""] ltr:hx-ml-3 ltr:hx-pl-3 ltr:before:hx-left-0 rtl:hx-mr-3 rtl:hx-pr-3 rtl:before:hx-right-0 dark:before:hx-bg-neutral-800'><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/c2-and-red-team-tools/havoc/>Havoc</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/c2-and-red-team-tools/malware-droppers/>Malware Droppers</a></li></ul></div></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/other-cheatsheets/>++ cyber cheatsheets</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/computer-science--programming/>Computer Science & Programming
<span class=hextra-sidebar-collapsible-button><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="hx-h-[18px] hx-min-w-[18px] hx-rounded-sm hx-p-0.5 hover:hx-bg-gray-800/5 dark:hover:hx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="hx-origin-center hx-transition-transform rtl:-hx-rotate-180"/></svg></span></a><div class="ltr:hx-pr-0 hx-overflow-hidden"><ul class='hx-relative hx-flex hx-flex-col hx-gap-1 before:hx-absolute before:hx-inset-y-1 before:hx-w-px before:hx-bg-gray-200 before:hx-content-[""] ltr:hx-ml-3 ltr:hx-pl-3 ltr:before:hx-left-0 rtl:hx-mr-3 rtl:hx-pr-3 rtl:before:hx-right-0 dark:before:hx-bg-neutral-800'><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/computer-science--programming/ai-tools/>Ai Tools</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/computer-science--programming/docker/>Docker</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/computer-science--programming/file-synchronisation/>File Synchronisation</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/computer-science--programming/git/>Git</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/computer-science--programming/image-modifications/>Image Modifications</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/computer-science--programming/latex/>Latex</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/computer-science--programming/orchestration-workflows/>Orchestration (Workflows)</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/computer-science--programming/versioning/>Versioning</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/computer-science--programming/web-dev-cheatsheet/>Web Dev Cheatsheet</a></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/computer-science--programming/web-proxies/>Web Proxies</a></li></ul></div></li><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/other/>Other
<span class=hextra-sidebar-collapsible-button><svg fill="none" viewBox="0 0 24 24" stroke="currentcolor" class="hx-h-[18px] hx-min-w-[18px] hx-rounded-sm hx-p-0.5 hover:hx-bg-gray-800/5 dark:hover:hx-bg-gray-100/5"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" class="hx-origin-center hx-transition-transform rtl:-hx-rotate-180"/></svg></span></a><div class="ltr:hx-pr-0 hx-overflow-hidden"><ul class='hx-relative hx-flex hx-flex-col hx-gap-1 before:hx-absolute before:hx-inset-y-1 before:hx-w-px before:hx-bg-gray-200 before:hx-content-[""] ltr:hx-ml-3 ltr:hx-pl-3 ltr:before:hx-left-0 rtl:hx-mr-3 rtl:hx-pr-3 rtl:before:hx-right-0 dark:before:hx-bg-neutral-800'><li class="hx-flex hx-flex-col"><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=/bazaar/other/password-cracking/>Password Cracking</a></li></ul></div></li></ul></div></li><li class="[word-break:break-word] hx-mt-5 hx-mb-2 hx-px-2 hx-py-1.5 hx-text-sm hx-font-semibold hx-text-gray-900 first:hx-mt-0 dark:hx-text-gray-100"><span class=hx-cursor-default>Bottom text</span></li><li><a class="hx-flex hx-items-center hx-justify-between hx-gap-2 hx-cursor-pointer hx-rounded hx-px-2 hx-py-1.5 hx-text-sm hx-transition-colors [-webkit-tap-highlight-color:transparent] [-webkit-touch-callout:none] [word-break:break-word]
hx-text-gray-500 hover:hx-bg-gray-100 hover:hx-text-gray-900 contrast-more:hx-border contrast-more:hx-border-transparent contrast-more:hx-text-gray-900 contrast-more:hover:hx-border-gray-900 dark:hx-text-neutral-400 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50 contrast-more:dark:hx-text-gray-50 contrast-more:dark:hover:hx-border-gray-50" href=http://blinking.dog target=_blank rel=noreferrer>ðŸ¦§</a></li></ul><div class="max-xl:hx-hidden hx-h-0 hx-w-64 hx-shrink-0"></div></div><div class="md:hx-hidden hx-sticky hx-bottom-0 hx-bg-white dark:hx-bg-dark hx-mx-4 hx-py-4 hx-shadow-[0_-12px_16px_#fff] hx-flex hx-items-center hx-gap-2 dark:hx-border-neutral-800 dark:hx-shadow-[0_-12px_16px_#111] contrast-more:hx-border-neutral-400 contrast-more:hx-shadow-none contrast-more:dark:hx-shadow-none hx-border-t" data-toggle-animation=show><div class="hx-flex hx-grow hx-flex-col"><button title="Change theme" data-theme=light class="theme-toggle hx-group hx-h-7 hx-rounded-md hx-px-2 hx-text-left hx-text-xs hx-font-medium hx-text-gray-600 hx-transition-colors dark:hx-text-gray-400 hover:hx-bg-gray-100 hover:hx-text-gray-900 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50" type=button aria-label="Change theme"><div class="hx-flex hx-items-center hx-gap-2 hx-capitalize"><svg height="12" class="group-data-[theme=light]:hx-hidden" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg><span class="group-data-[theme=light]:hx-hidden">Light</span><svg height="12" class="group-data-[theme=dark]:hx-hidden" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg><span class="group-data-[theme=dark]:hx-hidden">Dark</span></div></button></div></div></aside><nav class="hextra-toc hx-order-last hx-hidden hx-w-64 hx-shrink-0 xl:hx-block print:hx-hidden hx-px-4" aria-label="table of contents"><div class="hextra-scrollbar hx-sticky hx-top-16 hx-overflow-y-auto hx-pr-4 hx-pt-6 hx-text-sm [hyphens:auto] hx-max-h-[calc(100vh-var(--navbar-height)-env(safe-area-inset-bottom))] ltr:hx--mr-4 rtl:hx--ml-4"><p class="hx-mb-4 hx-font-semibold hx-tracking-tight">On this page</p><ul><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-4 rtl:hx-pr-4 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#parsing-arguments>Parsing Arguments</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-8 rtl:hx-pr-8 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#parsing-ports>Parsing ports</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-8 rtl:hx-pr-8 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#parsing-targets>Parsing targets</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-4 rtl:hx-pr-4 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#icmp-ping-scan>ICMP (ping scan)</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-8 rtl:hx-pr-8 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#opsec>OPSEC</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-8 rtl:hx-pr-8 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#speed>Speed</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-4 rtl:hx-pr-4 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#tcp-port-scan>TCP (port scan)</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-8 rtl:hx-pr-8 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#port-scan-function>Port Scan Function</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-8 rtl:hx-pr-8 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#service-headers-and-information-discovery>Service Headers and Information Discovery</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-8 rtl:hx-pr-8 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#final-scanner>Final Scanner</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-8 rtl:hx-pr-8 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#opsec-1>OPSEC</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-4 rtl:hx-pr-4 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#converting-to-a-bof>Converting to a BOF</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-4 rtl:hx-pr-4 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#initial-release>Initial release</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-4 rtl:hx-pr-4 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#future-improvements>Future improvements</a></li><li class="hx-my-2 hx-scroll-my-6 hx-scroll-py-6"><a class="ltr:hx-pl-4 rtl:hx-pr-4 hx-inline-block hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-300 contrast-more:hx-text-gray-900 contrast-more:hx-underline contrast-more:dark:hx-text-gray-50 hx-w-full hx-break-words" href=#references>References</a></li></ul><div class="hx-mt-8 hx-border-t hx-bg-white hx-pt-8 hx-shadow-[0_-12px_16px_white] dark:hx-bg-dark dark:hx-shadow-[0_-12px_16px_#111] hx-sticky hx-bottom-0 hx-flex hx-flex-col hx-items-start hx-gap-2 hx-pb-8 dark:hx-border-neutral-800 contrast-more:hx-border-t contrast-more:hx-border-neutral-400 contrast-more:hx-shadow-none contrast-more:dark:hx-border-neutral-400"><button aria-hidden=true id=backToTop onclick=scrollUp() class="hx-transition-all hx-duration-75 hx-opacity-0 hx-text-xs hx-font-medium hx-text-gray-500 hover:hx-text-gray-900 dark:hx-text-gray-400 dark:hover:hx-text-gray-100 contrast-more:hx-text-gray-800 contrast-more:dark:hx-text-gray-50">
<span>Scroll to top</span><svg fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" class="hx-inline ltr:hx-ml-1 rtl:hx-mr-1 hx-h-3.5 hx-w-3.5 hx-border hx-rounded-full hx-border-gray-500 hover:hx-border-gray-900 dark:hx-border-gray-400 dark:hover:hx-border-gray-100 contrast-more:hx-border-gray-800 contrast-more:dark:hx-border-gray-50"><path stroke-linecap="round" stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5"/></svg></button></div></div></nav><article class="hx-w-full hx-break-words hx-flex hx-min-h-[calc(100vh-var(--navbar-height))] hx-min-w-0 hx-justify-center hx-pb-8 hx-pr-[calc(env(safe-area-inset-right)-1.5rem)]"><main class="hx-w-full hx-min-w-0 hx-max-w-6xl hx-px-6 hx-pt-4 md:hx-px-12"><div class="hx-mt-1.5 hx-flex hx-items-center hx-gap-1 hx-overflow-hidden hx-text-sm hx-text-gray-500 dark:hx-text-gray-400 contrast-more:hx-text-current"><div class="hx-whitespace-nowrap hx-transition-colors hx-min-w-[24px] hx-overflow-hidden hx-text-ellipsis hover:hx-text-gray-900 dark:hover:hx-text-gray-100"><a href=/articles/>articles</a></div><svg class="hx-w-3.5 hx-shrink-0 rtl:-hx-rotate-180" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/></svg><div class="hx-whitespace-nowrap hx-transition-colors hx-font-medium hx-text-gray-700 contrast-more:hx-font-bold contrast-more:hx-text-current dark:hx-text-gray-100 contrast-more:dark:hx-text-current">Replicating Cobalt Strike's Port Scanner BOF for Open-Source C2 | Fast OPSEC-Aware Ping & TCP Connect Scanning in C</div></div><h1 class="hx-mt-2 hx-text-4xl hx-font-bold hx-tracking-tight hx-text-slate-900 dark:hx-text-slate-100">Replicating Cobalt Strike's Port Scanner BOF for Open-Source C2 | Fast OPSEC-Aware Ping & TCP Connect Scanning in C</h1><div class="hx-mt-4 hx-mb-16 hx-text-gray-500 hx-text-sm hx-flex hx-items-center hx-flex-wrap hx-gap-y-2"><span class=hx-mr-1>January 24, 2025</span><span class=hx-mx-1>Â·</span><a href=https://fyx.me/articles target=_blank class="hx-group hx-inline-flex hx-items-center hx-text-current hx-gap-x-1.5 hx-mx-1" title=fyx(me)><img src=https://fyx.me/favicon.ico alt=fyx(me) class="hx-inline-block hx-h-4 hx-w-4 hx-rounded-full" loading=lazy><div class=group-hover:hx-underline>fyx(me)</div></a></div><div class=content><div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-orange-100 hx-bg-orange-50 hx-text-orange-800 dark:hx-border-orange-400/30 dark:hx-bg-orange-400/20 dark:hx-text-orange-300"><p class="hx-flex hx-items-center hx-font-medium">Tldr</p><div class="hx-w-full hx-min-w-0 hx-leading-7"><div class="hx-mt-6 hx-leading-7 first:hx-mt-0"><p>Was annoyed open source C2 tools had inferior port scanners compared to Cobalt Strike so I decided to replicate the functionality. Also wrote a ping scanner to help with host discovery. OPSEC may still require some improvements as described throughout the blog but the functionality is there.<br>The tool is available here: <a href=https://github.com/fyxme/portscanbof target=_blank rel=noopener>https://github.com/fyxme/portscanbof</a></p></div></div></div><p>On my quest to reviewing random C2&rsquo;s for pure self enjoyment, I&rsquo;ve come to realise that very few implement port-scanning for whatever reason.</p><p>While I understand that it&rsquo;s possible to use a socks proxy and perform <code>nmap</code> scans over the proxy using a TCP connect scan (<code>-sT</code> flag), it feels less convenient, generates a lot of unwanted network traffic, requires the beacon to communicate constantly (<code>sleep 0</code>) and may have DNS issues, which made me want to re-create the <a href=https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/post-exploitation_port-scanning.htm target=_blank rel=noopener>Cobalt Strike Port Scan</a> functionality.</p><p>It&rsquo;s already possible to run binaries (ie. <code>exe</code> and <code>dll</code>) via other BOFs like <a href=https://github.com/fortra/No-Consolation.git target=_blank rel=noopener>noconsolation</a>, using dotnet CLR to run csharp binaries inline or using a PowerShell port scanner via the C2&rsquo;s powershell functionality, however, a lot of these generate more IoCs than BOFs and their output formats don&rsquo;t integrate as well with C2&rsquo;s since they were not directly made for those.</p><p>Through reviewing a number of BOFs on Github, looking at custom C2 agents and more, I didn&rsquo;t find many implementing portscanning up to the level of Cobalt Strike&rsquo;s Port Scanner. Although, I will give the following honourable mentions:</p><ul><li><a href="https://github.com/rvrsh3ll/BOF_Collection/tree/master?tab=readme-ov-file#portscanc" target=_blank rel=noopener>rvrsh3ll&rsquo;s bofportscan BOF</a> which works well but only supports a single host and a single port</li><li><a href=https://github.com/MythicAgents/thanatos/ target=_blank rel=noopener>Mythic&rsquo;s thanatos agent</a> which seemed to be the most complete, supports <a href=https://github.com/MythicAgents/thanatos/blob/main/Payload_Type/thanatos/thanatos/agent_code/src/portscan.rs#L28 target=_blank rel=noopener>IP and IP subnets as well as ports and port ranges</a>. While the agent itself is really good and the <a href=https://blog.cybershenanigans.space/posts/thanatos-agent target=_blank rel=noopener>blog post</a> about it deserves a read, this port scan functionality is only available to users of this specific agent, isn&rsquo;t portable like a BOF, and still doesn&rsquo;t support as many arguments or output as Cobalt Strike&rsquo;s port scanner.</li></ul><p>Hence, the goals were set:</p><ul><li>write a portscanner BOF (COFF) that replicates <a href=https://hstechdocs.helpsystems.com/manuals/cobaltstrike/current/userguide/content/topics/post-exploitation_port-scanning.htm target=_blank rel=noopener>Cobalt Strikes Port Scanning</a> functionality including the wide variety of input parameters and provide the same amount of information as its output</li><li>write a pingscanner to complement the portscanner and use as a first pass scan</li><li>have some OPSEC considerations or at least describe the OPSEC limitations of the tool.</li></ul><p>The initial release will be used to test and improve the BOF in training environments and/or test labs, with future improvement adding functionality and improving OPSEC. We&rsquo;ll write the BOF in C as it&rsquo;s the most common language to use for BOFs.</p><p>Enough intro, let&rsquo;s begin.</p><h3>Parsing Arguments<span class="hx-absolute -hx-mt-20" id=parsing-arguments></span>
<a href=#parsing-arguments class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>Cobalt Strike&rsquo;s port scanner can be using the following way:</p><div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code"><pre><code>portscan [pid] [arch] [targets] [ports] [arp|icmp|none] [max connections] </code></pre><div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0"><button class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50" title="Copy code"><div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4"></div><div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4"></div></button></div></div><ul><li>The <code>[pid]</code> and <code>[arch]</code> options are used to &ldquo;inject into the specified process to run a port scan against the specified hosts&rdquo;. We&rsquo;ll ignore completely as our BOF will just execute within the context of the running agent. Nevertheless, this is a good functionality if you want to improve OPSEC as you may want to choose a process which is likely to perform arbitrary requests to other hosts (eg. a web browser for HTTP/HTTPS).</li><li>The <code>[targets]</code> option is a comma separated list of hosts to scan. You may also specify IPv4 address ranges (e.g., <code>192.168.1.128-192.168.2.240</code>, <code>192.168.1.0/24</code>)</li><li>The <code>[ports]</code> option is a comma separated list or ports to scan. You may specify port ranges as well (e.g., <code>1-65535</code>)</li><li>TheÂ <code>[arp|icmp|none]</code>Â target discovery options dictate how the port scanning tool will determine if a host is alive. <code>none</code> assumes that all hosts are alive. Instead of doing this in the port scan BOF itself, I&rsquo;ve decided to implement the <code>icmp</code> functionality in a different BOF (ie. <code>pingscan</code>) which will be described later on. The <code>arp</code> scan feature will be implemented as a feature update in a future release. For our portscan, we&rsquo;ll just assume that all hosts are alive (ie. <code>none</code>) and use timeouts instead to reduce the time it takes to perform a portscan.</li><li>Lastly, theÂ <code>[max connections]</code>Â option limits how many connections the port scan tool will attempt at any one time. While this is not hard to code, performing synchronous scans is actually already really fast if you set low enough timeouts (which should be fine considering you&rsquo;d expect low RTT in most internal environments). Nevertheless, this is a good feature that will be added in a future release.</li></ul><p>We&rsquo;ll split our BOF between <code>portscan</code> (ie. TCP connect scan) and <code>pingscan</code> (ie. ICMP echo/reply) with each being used the following way:</p><div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code"><pre><code>portscan [targets] [ports]
pingscan [targets]</code></pre><div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0"><button class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50" title="Copy code"><div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4"></div><div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4"></div></button></div></div><h4>Parsing ports<span class="hx-absolute -hx-mt-20" id=parsing-ports></span>
<a href=#parsing-ports class=subheading-anchor aria-label="Permalink for this section"></a></h4><p>Parsing ports is relatively easy, there&rsquo;s only three (3) options:</p><ul><li>a single port (eg. <code>22</code>,<code>445</code>,<code>80</code>, etc)</li><li>a port range (eg. <code>1-100</code>, <code>5000-6000</code>, etc)</li><li>an arbitrary combination of the two above options separated by a comma (eg. <code>22,5000-9000,445,7</code>)</li></ul><p>To improve user experience, we&rsquo;ll also allow decreasing port ranges (eg. <code>900-100</code>) for bragging rights on Cobalt Strike&rsquo;s <strong>inferior</strong> port scanning argument parser.</p><p>The pseudo-code for this is simple:</p><div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code"><pre><code>split input on &#34;,&#34;
for each part:
	if it contains a dash (&#34;-&#34;) assume its a range: 
		get both parts of the range using sscanf
		convert each part to an int
		check that each part is between 1 and 65535
	else assume its a port:
		convert str to int 
		check that the int is between 1 and 65535</code></pre><div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0"><button class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50" title="Copy code"><div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4"></div><div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4"></div></button></div></div><p>Assuming the parts are valid and passed our rudimentary checks, we need to store these ports. A design decision was made to use a linked list to store these as it reduces memory usage when large ranges are provided and easily allows arbitrary combinations to be made. To make things easier, we&rsquo;ll assume that a single port is the same as the range from that port to itself (ie. <code>"80" == "80-80"</code>), which allows us to use the following struct:</p><p><img src=../img/port_input%20struct.png alt="Port input struct" loading=lazy></p><h4>Parsing targets<span class="hx-absolute -hx-mt-20" id=parsing-targets></span>
<a href=#parsing-targets class=subheading-anchor aria-label="Permalink for this section"></a></h4><p>Parsing targets is a lot more involved since there are many available options, however we can split valid input options between the following input types:</p><ol><li><strong>IP Range:</strong> token contains a dash (<code>-</code>). Need to validate that each part of the dash is a valid IP otherwise you might end up matching hosts (eg. <code>asdf-asdf.com</code>).</li><li><strong>CIDR:</strong> that one is easy, just match on <code>/</code>, parse the IP and the mask and do calculations to find the IP range, which brings us back to type 1</li><li><strong>Host:</strong> you can use <a href=https://learn.microsoft.com/en-us/windows/win32/api/ws2tcpip/nf-ws2tcpip-getaddrinfo target=_blank rel=noopener>getaddrinfo</a> to do the work for you here as it will find IPs for hostnames for you.</li><li><strong>IP:</strong> similarly to hosts, we can use <code>getaddrinfo</code> and validate the IP which allows us to treat single IPs, the same way as single Hosts.</li><li>A combination of any of the above input types, split by a comma (<code>,</code>)</li></ol><p>In the end, you can categorise each target into one of two categories:</p><ul><li><strong>IP Range:</strong> IP ranges, and CIDR Subnet (ie. an IP range in disguise)</li><li><strong>IP/Host:</strong> Everything else that was parsed correctly by <code>getaddrinfo</code></li></ul><p>Similarly to port arguments, we&rsquo;ll use a linked list to store the information as it provides the most flexibility. This results in the following struct definitions:</p><p><img src=../img/Host%20Input%20Structs.png alt="Host Input Structs" loading=lazy></p><div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-indigo-200 hx-bg-indigo-100 hx-text-indigo-900 dark:hx-border-indigo-200/30 dark:hx-bg-indigo-900/30 dark:hx-text-indigo-200"><p class="hx-flex hx-items-center hx-font-medium"><svg height="16" class="hx-inline-block hx-align-middle hx-mr-2" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12A9 9 0 113 12a9 9 0 0118 0z"/></svg>Important</p><div class="hx-w-full hx-min-w-0 hx-leading-7"><div class="hx-mt-6 hx-leading-7 first:hx-mt-0"><p><strong>OPSEC:</strong> TheÂ <strong>getaddrinfo</strong>Â function returns results for theÂ <strong>NS_DNS</strong>Â namespace. TheÂ <strong>getaddrinfo</strong>Â function aggregates all responses if more than one namespace provider returns information. For use with the IPv6 and IPv4 protocol, name resolution can be by the Domain Name System (DNS), a localÂ <em>hosts</em>Â file, or by other naming mechanisms for theÂ <strong>NS_DNS</strong>Â namespace. (<a href=https://learn.microsoft.com/en-us/windows/win32/api/ws2tcpip/nf-ws2tcpip-getaddrinfo#remarks target=_blank rel=noopener>ref</a>)</p><p>ie. <code>getaddrinfo</code> will resolve host names to their IPs. This potentially results in network traffic being generating while parsing input. To limit network traffic, we store a pointer to the <code>addrinfo</code> struct populated after running <code>getaddrinfo</code> and we&rsquo;ll reuse it during scanning operations.</p></div></div></div><p>Correct parsing results in the following (with reversible IP ranges to assert dominance on Cobalt Strike&rsquo;s inferior parser):</p><p><img src=../img/Parser%20Testing.png alt="Parser Testing" loading=lazy></p><h3>ICMP (ping scan)<span class="hx-absolute -hx-mt-20" id=icmp-ping-scan></span>
<a href=#icmp-ping-scan class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>Windows API provides a very easy to use function to send ICMP echo requests, namely <a href=https://learn.microsoft.com/en-us/windows/win32/api/icmpapi/nf-icmpapi-icmpsendecho target=_blank rel=noopener>IcmpSendEcho</a>. We can use this function to send ICMP echoes to our targets easily:</p><div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code"><div><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=c1>// The **IcmpSendEcho** function sends an IPv4 ICMP echo request and returns any echo response replies. The call returns when the time-out has expired or the reply buffer is filled.
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>IPHLPAPI_DLL_LINKAGE</span> <span class=n>DWORD</span> <span class=nf>IcmpSendEcho</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=n>in</span><span class=p>]</span>           <span class=n>HANDLE</span>                 <span class=n>IcmpHandle</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=n>in</span><span class=p>]</span>           <span class=n>IPAddr</span>                 <span class=n>DestinationAddress</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=n>in</span><span class=p>]</span>           <span class=n>LPVOID</span>                 <span class=n>RequestData</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=n>in</span><span class=p>]</span>           <span class=n>WORD</span>                   <span class=n>RequestSize</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=n>in</span><span class=p>,</span> <span class=n>optional</span><span class=p>]</span> <span class=n>PIP_OPTION_INFORMATION</span> <span class=n>RequestOptions</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=n>out</span><span class=p>]</span>          <span class=n>LPVOID</span>                 <span class=n>ReplyBuffer</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=n>in</span><span class=p>]</span>           <span class=n>DWORD</span>                  <span class=n>ReplySize</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>[</span><span class=n>in</span><span class=p>]</span>           <span class=n>DWORD</span>                  <span class=n>Timeout</span>
</span></span><span class=line><span class=cl><span class=p>);</span></span></span></code></pre></div></div><div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0"><button class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50" title="Copy code"><div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4"></div><div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4"></div></button></div></div><p>The function takes in a <code>HANDLE IcmpHandle</code> as its first parameter which denotes a handle returned by the <a href=https://learn.microsoft.com/en-us/windows/desktop/api/icmpapi/nf-icmpapi-icmpcreatefile target=_blank rel=noopener>IcmpCreateFile</a> function (ie. a &ldquo;function which opens a handle on which IPv4 ICMP echo requests can be issued.&rdquo;). From testing, it appears we can reuse this file allowing us to create the initial handle and reuse it on subsequent calls to <code>IcmpSendEcho</code> resulting in improved scanning speed.</p><h4>OPSEC<span class="hx-absolute -hx-mt-20" id=opsec></span>
<a href=#opsec class=subheading-anchor aria-label="Permalink for this section"></a></h4><p>I wanted to see the network traffic difference between the <code>IcmpSendEcho</code> default configuration and the traffic generated from the <code>ping.exe</code> Windows utility. As it turns out, there is quite a bit of a difference:</p><p><img src=../img/Wireshark%20Ping%20Comparison.png alt="Wireshark Ping Comparison" loading=lazy></p><p>We notice the following from the screenshot above:</p><ul><li><code>ping.exe</code>: the ICMP requests and replies from the first four packets (those generated by the <code>ping</code> utility) are all 74 bytes long. The packet&rsquo;s time to live (ie. <code>ttl</code>) is set to 128ms.</li><li><code>IcmpSendEcho</code>: the request packets are 46 bytes long and the reply packets are 60 bytes long. The packet&rsquo;s TTL defaults to 255ms.</li></ul><p>By comparing the requests packets, we notice that the <code>ping</code> utility sends data as part of the request, namely the following string <code>abcdefghijklmnopqrstuvwabdcefghi</code>.</p><p><img src=../img/Wireshark%20Ping%20Packet%20Data.png alt="Wireshark Ping Packet Data" loading=lazy></p><p>We can match this in our function call by passing in <code>RequestData</code>, and adjust the packet&rsquo;s TTL to 128ms. This results in the following traffic being generated which is now identical between both <code>ping.exe</code> and our ping scanner:</p><p><img src=../img/Wireshark%20ICMP%20Packet%20Size%2074.png alt="Wireshark ICMP Packet Size 74" loading=lazy></p><div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-blue-200 hx-bg-blue-100 hx-text-blue-900 dark:hx-border-blue-200/30 dark:hx-bg-blue-900/30 dark:hx-text-blue-200"><p class="hx-flex hx-items-center hx-font-medium"><svg height="16" class="hx-inline-block hx-align-middle hx-mr-2" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12A9 9 0 113 12a9 9 0 0118 0z"/></svg>Note</p><div class="hx-w-full hx-min-w-0 hx-leading-7"><div class="hx-mt-6 hx-leading-7 first:hx-mt-0"><p>The ping reply size difference was simply due to the difference in data being sent (since the reply contains the data our packet has sent), hence no further configuration was needed.</p></div></div></div><p>With configurations and optimisations via timeout, this results in the following code:</p><p><img src=../img/ping_ip%20c%20code.png alt="Ping IP C code" loading=lazy></p><div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-orange-100 hx-bg-orange-50 hx-text-orange-800 dark:hx-border-orange-400/30 dark:hx-bg-orange-400/20 dark:hx-text-orange-300"><p class="hx-flex hx-items-center hx-font-medium">Danger</p><div class="hx-w-full hx-min-w-0 hx-leading-7"><div class="hx-mt-6 hx-leading-7 first:hx-mt-0"><p><strong>OPSEC:</strong> Other than the improvements described above, the tool does not currently add any delay between ping requests which can result in extremely fast consecutive requests being made which could lead to Denial of Service (DoS) on fragile hosts/environments if you&rsquo;re not careful. Further customisation options will added in a future release to help improve OPSEC, as well as the ability to configure a custom timeout. The defaults will be adjusted to <code>ping.exe</code>&rsquo;s timeouts.</p></div></div></div><p>We can combine this with the parser to have a working <code>pingscanner</code> that supports many input types:</p><p><img src=../img/icmp.exe%20ping%20cflare%20subnet.png alt="icmp.exe Ping cflare subnet" loading=lazy></p><h4>Speed<span class="hx-absolute -hx-mt-20" id=speed></span>
<a href=#speed class=subheading-anchor aria-label="Permalink for this section"></a></h4><p>Surprisingly if you don&rsquo;t add a delay between the ping requests, it&rsquo;s actually <a href="https://www.youtube.com/watch?v=6E7ZGCfruaw" target=_blank rel=noopener>extremely fast</a>&mldr; Who knew&mldr;</p><p>Without multi-threading or any other optimisations, running it against a <code>/24</code> subnet (ie. 255 IPs) with low response times, you can scan the whole subnet in about 4 seconds:
<img src=../img/icmp_scan_24subnet_4s.png alt="ICMP scan 24 subnet 4s" loading=lazy></p><p>Just watch out&mldr; If you ping scan too quickly, you get angry neighbours&mldr; From ~20ms to over 10 times that for each ping:</p><p><img src=../img/icmp.exe%20ping%20cflare%20subnet.png alt="icmp.exe Ping cflare subnet" loading=lazy>
<img src=../img/icmp.exe%20Ping%20cflare%20subnet%20error.png alt="icmp.exe Ping cflare subnet error" loading=lazy></p><p>From testing, it appears there are two events which can slow down the ping scan:</p><ul><li>A ping request timeout which results in error <code>11010</code> aka <code>IP_REQ_TIMED_OUT</code>. This is possible to optimise by setting the request timeout in <code>IcmpSendEcho</code>, although there is a trade-off where you may end up with false negatives (ie. the host exists but took longer than timeout time to respond).</li></ul><p><img src=../img/ping_error_11010.png alt="Ping Error 11010" loading=lazy></p><ul><li>Supplying non existant domains will result in delay from <code>getaddrinfo</code>. Unfortunately, it doesn&rsquo;t have a timeout so you&rsquo;d need to run it in a thread and time it out yourself if you wanted to optimise this. Or implement DNS requests yourself, but I&rsquo;ll leave that as an exercise for the reader.</li></ul><p><img src=../img/nslookup%20nsaindisguise.com.png alt="nslookup nsaindisguise.com" loading=lazy>
Furthermore, <code>getaddrinfo</code> is also extremely slow when provided with invalid input&mldr; A stunning 2.4s to say that the <a href=https://media.makeameme.org/created/you-dont-say-5ab1f3.jpg target=_blank rel=noopener>host doesn&rsquo;t exist</a>:
<img src=../img/icmp.exe%20digits%20slow.png alt="icmp.exe digits slow" loading=lazy></p><p>The simplest fix to the above would be to check whether the input is a valid IP or hostname based on a regex, although this is harder than expected because in an internal environment, pretty much anything could be a valid hostname&mldr;.</p><p>OPSEC wise performing a scan this fast really isn&rsquo;t great and will start flooding the network with too many packets, potentially generating alerts or breaking stuff. But damn it&rsquo;s fun to see the packets go by at MACH 2 speed!</p><p>I&rsquo;ll add IP/Host validation as an optimisation in the backlog, move on to another project and never implement it. But at least you know its there&mldr; So yeah, don&rsquo;t pass stupid data to it and you should be sweet!</p><h3>TCP (port scan)<span class="hx-absolute -hx-mt-20" id=tcp-port-scan></span>
<a href=#tcp-port-scan class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>Before attempting to write a port scanner, I looked at the <a href="https://www.youtube.com/watch?v=qzZCYIKH6fM" target=_blank rel=noopener>video</a> linked on Cobalt Strike&rsquo;s website about the Port Scanning functionality. From this, I gathered a few things I wanted to include in this port scanner:</p><ul><li>The port scanner shows all open ports (that&rsquo;s an obvious one)</li><li>For each port/service it finds, if the service supplies a banner (ie. SSH), then it will receive the banner and display it</li><li>The scanner provides additional information for Windows hosts with SMB open (port 445)</li></ul><p>This is the functionality I wanted to replicate with this BOF.</p><h4>Port Scan Function<span class="hx-absolute -hx-mt-20" id=port-scan-function></span>
<a href=#port-scan-function class=subheading-anchor aria-label="Permalink for this section"></a></h4><div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-blue-200 hx-bg-blue-100 hx-text-blue-900 dark:hx-border-blue-200/30 dark:hx-bg-blue-900/30 dark:hx-text-blue-200"><p class="hx-flex hx-items-center hx-font-medium"><svg height="16" class="hx-inline-block hx-align-middle hx-mr-2" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12A9 9 0 113 12a9 9 0 0118 0z"/></svg>Note</p><div class="hx-w-full hx-min-w-0 hx-leading-7"><div class="hx-mt-6 hx-leading-7 first:hx-mt-0"><p>This is describing a TCP Connect Scan. If you are interested in other types of scans, checkout nmap&rsquo;s <a href=https://nmap.org/book/scan-methods.html target=_blank rel=noopener>book</a> on scan methods.</p></div></div></div><p>Port scanning in itself is very simple, you have an IP and a port, you connect to an address, if the socket connects successfully, that port is open, if the socket errors that port is closed. Translate to code, this looks something like this (assuming WSA is initialised outside of this function):</p><p><img src=../img/isPortOpen%20source%20code.png alt="isPortOpen source code" loading=lazy></p><p>Not much going on here but this would also make a terrible port scanner because it would be terribly slow when you try to scan a port/service that doesn&rsquo;t exist (ie. you&rsquo;d get timed out but it would take a while). The screenshot below demonstrates this. It&rsquo;s pretty much instant when the service exists (<code>Elapsed time: 0.00 seconds</code>) but takes forever when the services do not respond (<code>Elapsed time: 42.00 seconds</code>):</p><p><img src=../img/port%20scanning%20slow%20example.png alt="port scanning slow example" loading=lazy></p><p>To improve the speed we can set a timeout when the socket attempts to connect to the remote port/service. On Windows, this results to setting the socket to non-blocking mode and using the <a href=https://learn.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-select target=_blank rel=noopener>select</a> function to wait for the socket to successfully connect or timeout. This allows us to set a socket timeout and greatly increase the speed of the program:</p><p><img src=../img/updated%20isPortOpen%20with%20timeout.png alt="updated isPortOpen with timeout" loading=lazy></p><p>The code above results in an increase of 41 seconds over the old code:</p><p><img src=../img/portscanning%20with%20timeout%20for%20speed.png alt="portscanning with timeout for speed" loading=lazy></p><p>Lastly, since we want to receive the headers from sockets we successfully connect to, we should set a timeout on the socket receive too. We can do this using the <a href=https://learn.microsoft.com/en-us/windows/win32/api/winsock/nf-winsock-setsockopt target=_blank rel=noopener>setsocketopt</a> function prior to connecting to the socket as such:</p><p><img src=../img/setsockopt%20timeout%20example.png alt="setsockopt timeout example" loading=lazy></p><p>This is pretty much it in terms of basic setup and allows us to identify open ports at a reasonable speed. We can now move on to more fun stuff like receive service headers and querying Windows Host information.</p><h4>Service Headers and Information Discovery<span class="hx-absolute -hx-mt-20" id=service-headers-and-information-discovery></span>
<a href=#service-headers-and-information-discovery class=subheading-anchor aria-label="Permalink for this section"></a></h4><p>In the video posted on the Cobalt Strike website, they show banner information retrieved when port scanning:</p><p><img src=../img/cobalt%20strike%20video%20screenshot%20scanner%20output.png alt="cobalt strike video screenshot scanner output" loading=lazy></p><p>Now, the simple headers like <code>SSH</code> are simply sent upon connecting to the service. You just need to receive after connecting to the socket. You don&rsquo;t even need to send any data:</p><p><img src=../img/netcat%20port%2022%20ssh%20banner.png alt="netcat port 22 ssh banner" loading=lazy></p><p>This is trivial to add to our scanner using the following snippet:</p><p><img src=../img/c%20socket%20receive%20data.png alt="c socket receive data" loading=lazy>
<em><strong>Note:</strong> In the above snippet, we are setting the socket back to blocking mode, however if we wanted to keep it asynchronous we could use a similar approach as what we did for <code>connect</code>, check the WSA Error and use <code>select</code> to wait for the <code>recv</code> function to end or timeout.</em></p><p>I knew you could get computer information from SMB such as hostname and domain but I&rsquo;ve never had to implement it in code so I wasn&rsquo;t sure where to get it from. The computer information seemed harder to get from SMB and I thought surely you wouldn&rsquo;t get that from simply connecting to the socket. Spoiler alert, you don&rsquo;t&mldr;</p><p>So I went down the rabbit hole and found some documentation on how to get server information on MS Documentation. I started by using <a href=https://learn.microsoft.com/en-us/windows/win32/api/lmserver/nf-lmserver-netservergetinfo target=_blank rel=noopener>NetServerGetInfo</a> to try and retrieve the same information as in the cobalt strike clip&mldr; Turns out it was not that&mldr;. I didn&rsquo;t get much information from it but was on the right track:</p><p><img src=../img/server-info.exe%20NetServerGetInfo.png alt="server-info.exe NetServerGetInfo" loading=lazy></p><p>Did more digging and found another more promising function, namely <a href=https://learn.microsoft.com/en-us/windows/win32/api/lmwksta/nf-lmwksta-netwkstagetinfo target=_blank rel=noopener>NetWkstaGetInfo</a>. And as it turns out, it looks like this is what they are using under the hood. I was able to get the exact same information as Cobalt Strike&rsquo;s port scanner from that one function call:</p><p><img src=../img/server-info.exe%20NetWkstaGetInfo.png alt="server-info.exe NetWkstaGetInfo" loading=lazy></p><div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-blue-200 hx-bg-blue-100 hx-text-blue-900 dark:hx-border-blue-200/30 dark:hx-bg-blue-900/30 dark:hx-text-blue-200"><p class="hx-flex hx-items-center hx-font-medium"><svg height="16" class="hx-inline-block hx-align-middle hx-mr-2" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12A9 9 0 113 12a9 9 0 0118 0z"/></svg>Note</p><div class="hx-w-full hx-min-w-0 hx-leading-7"><div class="hx-mt-6 hx-leading-7 first:hx-mt-0"><p>You can request different levels of information from both <code>NetWkstaGetInfo</code> and <code>NetServerGetInfo</code>.</p><p>Example for <code>NetWkstaGetInfo</code>:</p><ul><li>Anonymous access is always permitted for <a href=https://learn.microsoft.com/en-us/windows/win32/api/lmwksta/ns-lmwksta-wksta_info_100 target=_blank rel=noopener>level 100</a>.</li><li>Authenticated users can view additional information at <a href=https://learn.microsoft.com/en-us/windows/win32/api/lmwksta/ns-lmwksta-wksta_info_101 target=_blank rel=noopener>level 101</a></li><li>Members of the Administrators, and the Server, System and Print Operator local groups can view information at <a href=https://learn.microsoft.com/en-us/windows/win32/api/lmwksta/ns-lmwksta-wksta_info_102 target=_blank rel=noopener>levels 102</a>.</li></ul><p>We&rsquo;re using level 100 here since we want to do this unauthenticated.</p></div></div></div><p>All that remained was adding the following code to our scanner:</p><p><img src=../img/C%20get_server_info%20function.png alt="C get_server_info function" loading=lazy></p><h4>Final Scanner<span class="hx-absolute -hx-mt-20" id=final-scanner></span>
<a href=#final-scanner class=subheading-anchor aria-label="Permalink for this section"></a></h4><p>After implementing all of the above, we have a scanner that can identify open ports, prints Windows host information and displays service banners:</p><p><img src=../img/Havoc%20Final%20Scanner%20output.png alt="Havoc Final Scanner output" loading=lazy></p><p>However, it&rsquo;s not a BOF yet&mldr;</p><h4>OPSEC<span class="hx-absolute -hx-mt-20" id=opsec-1></span>
<a href=#opsec-1 class=subheading-anchor aria-label="Permalink for this section"></a></h4><p>At the moment the tool scans all selected ports on one (1) IP before moving on to the next, however it might be better to do the opposite and scan one (1) port on all IPs and move on to the next port.</p><p>An even better solution might be to randomly choose 1 port and 1 IP and scan that, although if you see random ports and IPs popping up in logs than it also might stand out as weird&mldr; More research required.</p><p>Interestingly, looking at the output from Cobalt Strike&rsquo;s video demonstrating their port scanner, I noticed two things:</p><ul><li>They are scanning IPs and ports from highest to lowest (probably due to how they are parsing the arguments). You can see the first service to come back is port <code>5357</code> on <code>10.10.10.2222</code>:</li></ul><p><img src=../img/Cobalt%20Strike%20IP%20scan%20start.png alt="Cobalt Strike IP scan start" loading=lazy></p><p>And after the video cut, you can see the IPs are decreasing and ports too:</p><p><img src=../img/Cobalt%20Strike%20tool%20output%20IP%20decreasing%20order.png alt="Cobalt Strike tool output IP decreasing order" loading=lazy></p><ul><li>They perform the <code>NetWkstaGetInfo</code> on all hosts with port 445 open <strong>at the end of the scan</strong>, which is why you see all of the port 445 hosts popup at once:</li></ul><p><img src=../img/Cobalt%20Strike%20tool%20output%20NetWkstaGetInfo.png alt="Cobalt Strike tool output NetWkstaGetInfo" loading=lazy></p><p>No idea if their design is better or not. Need to test it inside a lab environment where monitoring tools are in place to gain a better idea. Good follow up research!</p><h3>Converting to a BOF<span class="hx-absolute -hx-mt-20" id=converting-to-a-bof></span>
<a href=#converting-to-a-bof class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>A follow up blog will be released highlighting how the scanners were converted to BOFs and will cover the following topics:</p><ul><li>Dynamic Resolution of Win32 APIs and generating function declaration mappings automatically</li><li>Compiling larger BOFs with multiple c files</li><li>Improved BOF output through batching prints</li></ul><p>In the meantime, you can enjoy using the tool by downloading it from github: <a href=https://github.com/fyxme/portscanbof target=_blank rel=noopener>https://github.com/fyxme/portscanbof</a></p><h3>Initial release<span class="hx-absolute -hx-mt-20" id=initial-release></span>
<a href=#initial-release class=subheading-anchor aria-label="Permalink for this section"></a></h3><p>After converting the application to a BOF and cleaning up the output, we get the following:</p><p><img src=../img/Initial%20Release%20Example%20screenshot.png alt="Initial Release Example Screenshot" loading=lazy></p><p>The code and usage guide has been released publicly and can be found here: <a href=https://github.com/fyxme/portscanbof target=_blank rel=noopener>https://github.com/fyxme/portscanbof</a></p><p>The tool may have been update since this blog was written. See the corresponding GitHub repository for up to date information.</p><h3>Future improvements<span class="hx-absolute -hx-mt-20" id=future-improvements></span>
<a href=#future-improvements class=subheading-anchor aria-label="Permalink for this section"></a></h3><ul><li><del>Add async/multi-threading support for TCP scan</del> - This has been added since this blog was written. Still need to do more testing but good for now</li><li>ARP scan</li><li>Add the ability to check if the host is alive before running a TCP scan (similar to how cobaltstrike does it)</li><li>Additional arguments including timeout, number of threads, only scan 1 ip per host, etc</li><li>Add sleep delay option between ICMP requests to prevent DOS and improve OPSEC (approx 1 second delay from <code>ping.exe</code>)</li><li>Fix code and Makefile for compiling exe&rsquo;s</li><li>code refactor, and ensure all failure checks are validated (ie. memory allocation failures, etc)</li><li>UDP scan</li><li>IPV6 Support</li><li>Linux support</li></ul><h3>References<span class="hx-absolute -hx-mt-20" id=references></span>
<a href=#references class=subheading-anchor aria-label="Permalink for this section"></a></h3><ul><li><a href=https://gist.github.com/dascandy/544acdfdc907051bcaa0b51d6d4a334a target=_blank rel=noopener>https://gist.github.com/dascandy/544acdfdc907051bcaa0b51d6d4a334a</a></li><li><a href=https://github.com/rvrsh3ll/BOF_Collection/blob/master/Network/PortScan/PortScan.c target=_blank rel=noopener>https://github.com/rvrsh3ll/BOF_Collection/blob/master/Network/PortScan/PortScan.c</a></li><li><a href=https://github.com/tijme/amd-ryzen-master-driver-v17-exploit target=_blank rel=noopener>https://github.com/tijme/amd-ryzen-master-driver-v17-exploit</a></li><li><a href=https://trustedsec.com/blog/bofs-for-script-kiddies target=_blank rel=noopener>https://trustedsec.com/blog/bofs-for-script-kiddies</a></li><li><a href=https://blog.cybershenanigans.space/posts/thanatos-agent target=_blank rel=noopener>https://blog.cybershenanigans.space/posts/thanatos-agent</a></li><li><a href=https://blog.cybershenanigans.space/posts/writing-bofs-without-dfr/ target=_blank rel=noopener>https://blog.cybershenanigans.space/posts/writing-bofs-without-dfr/</a></li><li><a href=https://www.elastic.co/security-labs/detonating-beacons-to-illuminate-detection-gaps target=_blank rel=noopener>https://www.elastic.co/security-labs/detonating-beacons-to-illuminate-detection-gaps</a></li><li><a href=https://beej.us/guide/bgnet/html/split/ target=_blank rel=noopener>https://beej.us/guide/bgnet/html/split/</a></li><li><a href=https://tangentsoft.com/wskfaq/ target=_blank rel=noopener>https://tangentsoft.com/wskfaq/</a></li><li><a href=https://blog.cybershenanigans.space/posts/writing-bofs-without-dfr/#intro target=_blank rel=noopener>https://blog.cybershenanigans.space/posts/writing-bofs-without-dfr/#intro</a></li><li><a href=https://github.com/rvrsh3ll/BOF_Collection/blob/master/Network/PortScan/portscan.cna target=_blank rel=noopener>https://github.com/rvrsh3ll/BOF_Collection/blob/master/Network/PortScan/portscan.cna</a></li><li><a href=https://github.com/wsummerhill/C2_RedTeam_CheatSheets/blob/main/CobaltStrike/BOF_Collections.md target=_blank rel=noopener>https://github.com/wsummerhill/C2_RedTeam_CheatSheets/blob/main/CobaltStrike/BOF_Collections.md</a></li><li><a href=https://github.com/phra/PEzor/blob/b4e5927775de49735e22dc4b352b7e45d750cb15/bof.cpp#L151 target=_blank rel=noopener>https://github.com/phra/PEzor/blob/b4e5927775de49735e22dc4b352b7e45d750cb15/bof.cpp#L151</a></li><li><a href=https://frn.sh/posts/sockets/ target=_blank rel=noopener>https://frn.sh/posts/sockets/</a></li></ul></div><div class=hx-mt-16></div><div class="hx-mb-8 hx-flex hx-items-center hx-border-t hx-pt-8 dark:hx-border-neutral-800 contrast-more:hx-border-neutral-400 dark:contrast-more:hx-border-neutral-400 print:hx-hidden"><a href=/articles/osep-exam-review/ title="OffSec Experienced Penetration Tester (OSEP) Exam Review" class="hx-flex hx-max-w-[50%] hx-items-center hx-gap-1 hx-py-4 hx-text-base hx-font-medium hx-text-gray-600 hx-transition-colors [word-break:break-word] hover:hx-text-primary-600 dark:hx-text-gray-300 md:hx-text-lg ltr:hx-pr-4 rtl:hx-pl-4"><svg class="hx-inline hx-h-5 hx-shrink-0 ltr:hx-rotate-180" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/></svg>OffSec Experienced Penetration Tester (OSEP) Exam Review</a><a href=/articles/creating-a-havoc-module-to-run-commands-on-all-agents-at-once-and-map-out-an-environment-passively/ title="Creating a Havoc Module to run commands on all agents at once and map out an environment passively" class="hx-flex hx-max-w-[50%] hx-items-center hx-gap-1 hx-py-4 hx-text-base hx-font-medium hx-text-gray-600 hx-transition-colors [word-break:break-word] hover:hx-text-primary-600 dark:hx-text-gray-300 md:hx-text-lg ltr:hx-ml-auto ltr:hx-pl-4 ltr:hx-text-right rtl:hx-mr-auto rtl:hx-pr-4 rtl:hx-text-left">Creating a Havoc Module to run commands on all agents at once and map out an environment passively<svg class="hx-inline hx-h-5 hx-shrink-0 rtl:-hx-rotate-180" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7"/></svg></a></div></main></article></div><footer class="hextra-footer hx-bg-gray-100 hx-pb-[env(safe-area-inset-bottom)] dark:hx-bg-neutral-900 print:hx-bg-transparent"><div class="hx-mx-auto hx-flex hx-gap-2 hx-py-2 hx-px-4 hx-max-w-screen-xl"><button title="Change theme" data-theme=light class="theme-toggle hx-group hx-h-7 hx-rounded-md hx-px-2 hx-text-left hx-text-xs hx-font-medium hx-text-gray-600 hx-transition-colors dark:hx-text-gray-400 hover:hx-bg-gray-100 hover:hx-text-gray-900 dark:hover:hx-bg-primary-100/5 dark:hover:hx-text-gray-50" type=button aria-label="Change theme"><div class="hx-flex hx-items-center hx-gap-2 hx-capitalize"><svg height="12" class="group-data-[theme=light]:hx-hidden" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"/></svg><span class="group-data-[theme=light]:hx-hidden">Light</span><svg height="12" class="group-data-[theme=dark]:hx-hidden" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"/></svg><span class="group-data-[theme=dark]:hx-hidden">Dark</span></div></button></div><hr class=dark:hx-border-neutral-800></footer><script defer src=/js/main.min.a6eb101c76cd824b14b5bb9fa54e34e4b6414edb5e56347f59c358ba151e0432.js integrity="sha256-pusQHHbNgksUtbufpU405LZBTtteVjR/WcNYuhUeBDI="></script><script defer src=/lib/flexsearch/flexsearch.bundle.min.0425860527cc9968f9f049421c7a56b39327d475e2e3a8f550416be3a9134327.js integrity="sha256-BCWGBSfMmWj58ElCHHpWs5Mn1HXi46j1UEFr46kTQyc="></script><script defer src=/en.search.min.4a72af14c5044971882cecddc91b1d5027c5a1ce9145e85eae7ee5145e971777.js integrity="sha256-SnKvFMUESXGILOzdyRsdUCfFoc6RRehern7lFF6XF3c="></script></body></html>