<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browser Detection</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #f5f5f5;
            color: #333;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
        }
        .result-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .browser-name {
            font-size: 2.5em;
            font-weight: bold;
            color: #3498db;
            text-align: center;
            margin-bottom: 10px;
        }
        .browser-version {
            font-size: 1.2em;
            color: #7f8c8d;
            text-align: center;
            margin-bottom: 20px;
        }
        .details {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        .detail-row:last-child {
            border-bottom: none;
        }
        .detail-label {
            font-weight: 600;
            color: #555;
        }
        .detail-value {
            color: #333;
            text-align: right;
            max-width: 60%;
            word-break: break-word;
        }
        .user-agent {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 0.85em;
            word-break: break-all;
            margin-top: 20px;
        }
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }
        .badge-chromium {
            background: #e3f2fd;
            color: #1976d2;
        }
        .badge-private {
            background: #fff3e0;
            color: #f57c00;
        }
        .explanation-card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .explanation-card h2 {
            color: #2c3e50;
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.5em;
        }
        .method {
            background: #f8f9fa;
            border-left: 4px solid #3498db;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 8px 8px 0;
        }
        .method h3 {
            margin: 0 0 10px 0;
            color: #2c3e50;
            font-size: 1.1em;
        }
        .method p {
            margin: 0;
            color: #555;
            line-height: 1.6;
        }
        .method code {
            background: #e8e8e8;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.9em;
        }
        .method.brave {
            border-left-color: #fb542b;
        }
        .method.chrome {
            border-left-color: #4285f4;
        }
        .method.ua {
            border-left-color: #27ae60;
        }
        .method.feature {
            border-left-color: #9b59b6;
        }
        .caveat {
            background: #fff8e1;
            border-radius: 8px;
            padding: 15px 20px;
            margin-top: 20px;
        }
        .caveat h3 {
            margin: 0 0 10px 0;
            color: #f57c00;
            font-size: 1em;
        }
        .caveat ul {
            margin: 0;
            padding-left: 20px;
            color: #555;
        }
        .caveat li {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <h1>Browser Detection</h1>

    <div class="result-card">
        <div class="browser-name" id="browserName">Detecting...</div>
        <div class="browser-version" id="browserVersion"></div>
        <div id="badges" style="text-align: center;"></div>

        <div class="details">
            <div class="detail-row">
                <span class="detail-label">Engine</span>
                <span class="detail-value" id="engine">-</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Platform</span>
                <span class="detail-value" id="platform">-</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Operating System</span>
                <span class="detail-value" id="os">-</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Mobile Device</span>
                <span class="detail-value" id="mobile">-</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Cookies Enabled</span>
                <span class="detail-value" id="cookies">-</span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Do Not Track</span>
                <span class="detail-value" id="dnt">-</span>
            </div>
        </div>

        <div class="user-agent">
            <strong>User Agent:</strong><br>
            <span id="userAgent"></span>
        </div>
    </div>

    <div class="explanation-card">
        <h2>How Browser Detection Works</h2>

        <div class="method brave">
            <h3>Detecting Brave Browser</h3>
            <p>
                Brave is tricky because it disguises itself as Chrome in the User Agent string for compatibility.
                However, Brave exposes a unique API: <code>navigator.brave.isBrave()</code>. This async method
                returns <code>true</code> only in Brave browser. This is the only reliable way to detect Brave,
                as user agent sniffing will incorrectly identify it as Chrome.
            </p>
        </div>

        <div class="method chrome">
            <h3>Detecting Chrome vs Other Chromium Browsers</h3>
            <p>
                Many browsers (Edge, Opera, Vivaldi, Brave) are built on Chromium and include "Chrome" in their
                user agent. To identify actual Google Chrome, we check for "Chrome" in the UA string AND verify
                that <code>navigator.vendor</code> contains "Google". Other Chromium browsers add their own
                identifiers (e.g., "Edg/", "OPR/", "Vivaldi/") which we check first before falling back to Chrome.
            </p>
        </div>

        <div class="method ua">
            <h3>User Agent String Parsing</h3>
            <p>
                The <code>navigator.userAgent</code> property contains browser, engine, and OS information.
                We use pattern matching to extract browser names and versions. For example, Firefox includes
                "Firefox/XX.X", Safari includes "Version/XX.X" and "Safari", and Edge includes "Edg/XX.X".
                The order of checks mattersâ€”we check for more specific browsers before generic ones.
            </p>
        </div>

        <div class="method feature">
            <h3>Feature Detection &amp; Navigator Properties</h3>
            <p>
                Beyond the user agent, we use other navigator properties: <code>navigator.platform</code> for
                the OS platform, <code>navigator.cookieEnabled</code> for cookie support, and
                <code>navigator.doNotTrack</code> for privacy preferences. We also detect mobile devices using
                regex patterns against the user agent for known mobile keywords.
            </p>
        </div>

        <div class="caveat">
            <h3>Limitations &amp; Caveats</h3>
            <ul>
                <li>User agents can be spoofed or modified by extensions and browser settings</li>
                <li>Some privacy browsers block or randomize fingerprinting data</li>
                <li>New browsers or versions may not be detected until patterns are updated</li>
                <li>Brave's API detection may fail if the browser has disabled the API</li>
                <li>Browser detection is generally discouraged in favor of feature detection for compatibility</li>
            </ul>
        </div>
    </div>

    <script>
        async function detectBrowser() {
            const ua = navigator.userAgent;
            const vendor = navigator.vendor || '';

            let browserName = 'Unknown';
            let browserVersion = '';
            let engine = 'Unknown';
            let isChromiumBased = false;

            // Check for Chromium-based browsers first
            if (ua.includes('Chrome') || ua.includes('Chromium')) {
                isChromiumBased = true;
                engine = 'Blink';
            }

            // Detect Brave - Brave has a special API
            const isBrave = await detectBrave();

            if (isBrave) {
                browserName = 'Brave';
                const match = ua.match(/Chrome\/(\d+\.[\d.]+)/);
                if (match) browserVersion = match[1];
            }
            // Edge (Chromium-based)
            else if (ua.includes('Edg/')) {
                browserName = 'Microsoft Edge';
                const match = ua.match(/Edg\/(\d+\.[\d.]+)/);
                if (match) browserVersion = match[1];
            }
            // Edge (Legacy)
            else if (ua.includes('Edge/')) {
                browserName = 'Microsoft Edge (Legacy)';
                engine = 'EdgeHTML';
                const match = ua.match(/Edge\/(\d+\.[\d.]+)/);
                if (match) browserVersion = match[1];
            }
            // Opera
            else if (ua.includes('OPR/') || ua.includes('Opera')) {
                browserName = 'Opera';
                const match = ua.match(/(?:OPR|Opera)\/(\d+\.[\d.]+)/);
                if (match) browserVersion = match[1];
            }
            // Vivaldi
            else if (ua.includes('Vivaldi')) {
                browserName = 'Vivaldi';
                const match = ua.match(/Vivaldi\/(\d+\.[\d.]+)/);
                if (match) browserVersion = match[1];
            }
            // Samsung Internet
            else if (ua.includes('SamsungBrowser')) {
                browserName = 'Samsung Internet';
                const match = ua.match(/SamsungBrowser\/(\d+\.[\d.]+)/);
                if (match) browserVersion = match[1];
            }
            // Chrome
            else if (ua.includes('Chrome') && vendor.includes('Google')) {
                browserName = 'Google Chrome';
                const match = ua.match(/Chrome\/(\d+\.[\d.]+)/);
                if (match) browserVersion = match[1];
            }
            // Firefox
            else if (ua.includes('Firefox')) {
                browserName = 'Mozilla Firefox';
                engine = 'Gecko';
                isChromiumBased = false;
                const match = ua.match(/Firefox\/(\d+\.[\d.]+)/);
                if (match) browserVersion = match[1];
            }
            // Safari
            else if (ua.includes('Safari') && !ua.includes('Chrome')) {
                browserName = 'Safari';
                engine = 'WebKit';
                isChromiumBased = false;
                const match = ua.match(/Version\/(\d+\.[\d.]+)/);
                if (match) browserVersion = match[1];
            }
            // Internet Explorer
            else if (ua.includes('MSIE') || ua.includes('Trident/')) {
                browserName = 'Internet Explorer';
                engine = 'Trident';
                isChromiumBased = false;
                const match = ua.match(/(?:MSIE |rv:)(\d+\.[\d.]+)/);
                if (match) browserVersion = match[1];
            }

            // Detect OS
            let os = 'Unknown';
            if (ua.includes('Windows NT 10')) os = 'Windows 10/11';
            else if (ua.includes('Windows NT 6.3')) os = 'Windows 8.1';
            else if (ua.includes('Windows NT 6.2')) os = 'Windows 8';
            else if (ua.includes('Windows NT 6.1')) os = 'Windows 7';
            else if (ua.includes('Mac OS X')) {
                const match = ua.match(/Mac OS X (\d+[._]\d+[._]?\d*)/);
                os = 'macOS' + (match ? ' ' + match[1].replace(/_/g, '.') : '');
            }
            else if (ua.includes('Android')) {
                const match = ua.match(/Android (\d+\.?\d*)/);
                os = 'Android' + (match ? ' ' + match[1] : '');
            }
            else if (ua.includes('iOS') || ua.includes('iPhone') || ua.includes('iPad')) {
                const match = ua.match(/OS (\d+[._]\d+)/);
                os = 'iOS' + (match ? ' ' + match[1].replace(/_/g, '.') : '');
            }
            else if (ua.includes('Linux')) os = 'Linux';
            else if (ua.includes('CrOS')) os = 'Chrome OS';

            // Check if mobile
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(ua);

            // Update UI
            document.getElementById('browserName').textContent = browserName;
            document.getElementById('browserVersion').textContent = browserVersion ? `Version ${browserVersion}` : '';
            document.getElementById('engine').textContent = engine;
            document.getElementById('platform').textContent = navigator.platform || 'Unknown';
            document.getElementById('os').textContent = os;
            document.getElementById('mobile').textContent = isMobile ? 'Yes' : 'No';
            document.getElementById('cookies').textContent = navigator.cookieEnabled ? 'Yes' : 'No';
            document.getElementById('dnt').textContent = navigator.doNotTrack === '1' ? 'Enabled' : 'Disabled';
            document.getElementById('userAgent').textContent = ua;

            // Add badges
            const badgesEl = document.getElementById('badges');
            if (isChromiumBased) {
                badgesEl.innerHTML += '<span class="badge badge-chromium">Chromium-based</span> ';
            }
            if (isBrave) {
                badgesEl.innerHTML += '<span class="badge badge-private">Privacy-focused</span>';
            }
        }

        async function detectBrave() {
            // Brave exposes navigator.brave.isBrave() method
            if (navigator.brave && typeof navigator.brave.isBrave === 'function') {
                try {
                    return await navigator.brave.isBrave();
                } catch (e) {
                    return false;
                }
            }
            return false;
        }

        // Run detection when page loads
        detectBrowser();
    </script>
</body>
</html>
